<div class="topbar">
  <div class="topbar-left">
    <div class="date-time">
      <span class="date">{{ currentDate | date:'EEEE, MMMM d, yyyy' }}</span>
      <span class="time">{{ currentDate | date:'HH:mm' }}</span>
    </div>
  </div>

  <div class="topbar-center">
    <div class="search-bar">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="11" cy="11" r="8"></circle>
        <path d="m21 21-4.35-4.35"></path>
      </svg>
      <input type="text" placeholder="Search matches, tickets, or statistics...">
    </div>
  </div>

  <div class="topbar-right">
    <button (click)="refreshData()" class="icon-button refresh-button" title="Refresh data">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M21 2v6h-6"></path>
      <path d="M3 12a9 9 0 0 1 15-6.7L21 8"></path>
      <path d="M3 22v-6h6"></path>
      <path d="M21 12a9 9 0 0 1-15 6.7L3 16"></path>
      </svg>
    </button>

    <div class="notifications-container">
      <button class="icon-button notifications-button" (click)="toggleNotifications()">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
          <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
        </svg>
        @if (notificationCount > 0) {
          <span class="notification-badge">{{ notificationCount }}</span>
        }
      </button>

      @if (showNotifications) {
        <div class="notifications-dropdown">
          <div class="dropdown-header">
            <h3>Notifications</h3>
            <button class="mark-read">Mark all as read</button>
          </div>
          <div class="notifications-list">
            <div class="notification-item">
              <div class="notification-icon success">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
              </div>
              <div class="notification-content">
                <p class="notification-title">50 tickets sold</p>
                <span class="notification-time">2 minutes ago</span>
              </div>
            </div>
            <div class="empty-state">No new notifications</div>
          </div>
        </div>
      }
    </div>

    <div class="user-menu-container">
      <button class="user-button" (click)="toggleUserMenu()">
        <div class="user-avatar">
          @if (userProfile?.avatar_url) {
            <img [src]="userProfile.avatar_url" alt="User avatar">
          } @else {
            <span>{{ userProfile?.username?.charAt(0)?.toUpperCase() || 'U' }}</span>
          }
        </div>
        <span class="user-name">{{ userProfile?.username || 'User' }}</span>
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
      </button>

      @if (showUserMenu) {
        <div class="user-dropdown">
          <div class="dropdown-item">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path>
              <circle cx="12" cy="7" r="4"></circle>
            </svg>
            <span>Profile</span>
          </div>
          <div class="dropdown-item">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="3"></circle>
              <path d="M12 1v6m0 6v6"></path>
              <path d="m4.93 4.93 4.24 4.24m5.66 5.66 4.24 4.24"></path>
              <path d="M1 12h6m6 0h6"></path>
              <path d="m4.93 19.07 4.24-4.24m5.66-5.66 4.24-4.24"></path>
            </svg>
            <span>Settings</span>
          </div>
          <div class="dropdown-divider"></div>
          <div class="dropdown-item danger" (click)="handleSignOut()">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
              <polyline points="16 17 21 12 16 7"></polyline>
              <line x1="21" y1="12" x2="9" y2="12"></line>
            </svg>
            <span>Sign Out</span>
          </div>
        </div>
      }
    </div>
  </div>
</div>